# Файловые системы и LVM

## Задание: "Работа с LVM"

### Цель: создавать и управлять логическими томами в LVM

#### LVM - начало работы

- Проверка, что стенд соответствует тому, что описан в методичке
  ![](images/img1.png)
  ![](images/img2.png)
- Создаем первые Physical volume, Volume group и Logical volume
  ![](images/img3.png)
- Проверяем что получилось
  ![](images/img4.png)
- Создаём еще один LV из свободного места. На этот раз не
  экстентами, а абсолютным значением в мегабайтах:
  ![](images/img5.png)
- Создадим на LV файловую систему и смонтируем его
  ![](images/img6.png)

#### Расширение LVM

- Создаём новый PV и добавим его в VG
  ![](images/img7.png)
- Сымитируем занятое место
  ![](images/img8.png)
- Увеличиваем LV
  ![](images/img9.png)
- Но файловая система при этом осталась прежнего размера
  ![](images/img10.png)
- Произведем resize файловой системы
  ![](images/img11.png)
- Уменьшение существующего LV
  ![](images/img12.png)
  ![](images/img13.png)

#### Работа со снапшотами

- Создание снапшота
  ![](images/img14.png)
- Монтирование снапшота
  ![](images/img15.png)
- Откат на снапшот
  ![](images/img16.png)

#### Работа с LVM-RAID

- Работа с LVM-RAID
  ![](images/img17.png)
  
#### Уменьшить том под / до 8G

- Подготовка временного тома для / раздела
  ![](images/img18.png)
- Копируем все данные с / раздела в /mnt
  ![](images/img19.png)
  ![](images/img20.png)
- Доп настройки чтобы стартануть с новой систему
  ![](images/img21.png)
- Проверка после перезагрузки где смонирован /
  ![](images/img22.png)
- Изменяем размер старой VG и возвращаем на него рут
  ![](images/img23.png)
  ![](images/img24.png)

#### Выделить том под /var в зеркало

- На свободных дисках создаем зеркало
  ![](images/img25.png)
- Создаем на нем ФС и перемещаем туда /var
  ![](images/img26.png)
- На всякий случай сохраняем содержимое старого var
  ![](images/img27.png)
- Монтируем новый var в каталог /var
  ![](images/img28.png)
- Правим fstab для автоматического монтирования /var
  ![](images/img29.png)
- Перезагружаемся в новый (уменьшенный root) и удаляем
  временную Volume Group
  ![](images/img30.png)
  ![](images/img31.png)

#### Выделить том под /home

- Выделяем том под /home по тому же принципу что делали для /var
  ![](images/img32.png)

#### Работа со снапшотами
 
- Работа со снапшотами
  ![](images/img33.png)
